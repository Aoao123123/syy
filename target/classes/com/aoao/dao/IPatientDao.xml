<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aoao.dao.IPatientDao">
    <resultMap id="patient12Map" type="com.aoao.domain.PatientLv1">
        <result property="patient_number_lv1" column="patient_number_lv1"></result>
        <result property="name" column="name"></result>
        <result property="department" column="department"></result>
        <result property="bed_number" column="bed_number"></result>
        <result property="age" column="age"></result>
        <result property="gender" column="gender"></result>
        <result property="height" column="height"></result>
        <result property="weight" column="weight"></result>
        <result property="sbp" column="sbp"></result>
        <result property="dbp" column="dbp"></result>
        <result property="r" column="r"></result>
        <result property="p" column="p"></result>
        <result property="t" column="t"></result>
        <result property="pre_diagnose" column="pre_diagnose"></result>
        <result property="assume" column="assume"></result>
        <result property="chief_complaint" column="chief_complaint"></result>
        <result property="others" column="others"></result>
        <result property="na" column="na"></result>
        <result property="k" column="k"></result>
        <result property="cl" column="cl"></result>
        <result property="wbc" column="wbc"></result>
        <result property="hb" column="hb"></result>
        <result property="plts" column="plts"></result>
        <result property="pt" column="pt"></result>
        <result property="aptt" column="aptt"></result>
        <result property="bun" column="bun"></result>
        <result property="creat" column="creat"></result>
        <result property="tbil" column="tbil"></result>
        <result property="ast" column="ast"></result>
        <result property="alt" column="alt"></result>
        <result property="glu" column="glu"></result>
        <result property="result_binary" column="result_binary"></result>
        <result property="lv1_binary" column="lv1_binary"></result>
        <result property="lv2_binary" column="lv2_binary"></result>
        <result property="firstAssessDoc" column="firstAssessDoc"></result>
        <result property="firstAssessDate" column="firstAssessDate"></result>
        <result property="secondAssessDoc" column="secondAssessDoc"></result>
        <result property="secondAssessDate" column="secondAssessDate"></result>
        <collection property="patientLv2List" ofType="com.aoao.domain.PatientLv2">
            <result column="patient_number_lv2" property="patient_number_lv2"></result>
            <result column="checkbox_binary" property="checkbox_binary"></result>
            <result column="remark" property="remark"></result>
            <result column="represent" property="represent"></result>
        </collection>
    </resultMap>

    <select id="findPatientByPatientNumber" parameterType="String" resultMap="patient12Map">
        select * from patient_lv1 patient1 left outer join patient_lv2 patient2
        on patient1.patient_number_lv1 = patient2.patient_number_lv2
        where patient_number_lv1 = #{patient_number_lv1}
    </select>

    <update id="updatePatientLv1Info" parameterType="com.aoao.domain.PatientLv1">
        update patient_lv1 patient1
        set patient1.lv1_binary = #{lv1_binary},patient1.lv2_binary = #{lv2_binary},patient1.result_binary = #{result_binary},
        patient1.firstAssessDoc = #{firstAssessDoc},patient1.firstAssessDate = #{firstAssessDate},patient1.secondAssessDoc = #{secondAssessDoc},
        patient1.secondAssessDate = #{secondAssessDate}
        where patient1.patient_number_lv1 = #{patient_number_lv1}
    </update>

    <insert id="insertPatientLv1Info" parameterType="com.aoao.domain.PatientLv1">
        insert into patient_lv1(patient_number_lv1,name) value(#{patient_number_lv1},#{name})
    </insert>

    <update id="updatePatientLv2Info" parameterType="com.aoao.domain.PatientLv2">
        update patient_lv2 patient2
        set patient2.checkbox_binary = #{checkbox_binary},patient2.remark = #{remark}
        where patient2.patient_number_lv2 = #{patient_number_lv2} and patient2.represent = #{represent}
    </update>

    <insert id="insertPatientLv2Info" parameterType="com.aoao.domain.PatientLv2">
        insert into patient_lv2(patient_number_lv2,checkbox_binary,remark,represent)
        value(#{patient_number_lv2},#{checkbox_binary},#{remark},#{represent})
    </insert>

    <delete id="deletePatientLv2Info" parameterType="com.aoao.domain.PatientLv2">
        delete from patient_lv2 where patient_number_lv2 = #{patient_number_lv2} and represent = #{represent}
    </delete>

</mapper>